<!DOCTYPE html>
<html lang="en" dir="ltr">
<head prefix="og: http://ogp.me/ns#">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-145066191-2"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-145066191-2');</script>
  <meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<title>sky_sequencer</title>
	<meta name="description" content="sky_sequencer">
	<link rel="shortcut icon" type="image/png" href="img/ico/seq.jpg">
	<meta property="og:type" content="website">
	<meta property="og:title" content="sky_sequencer">
	<meta property="og:description" content="Skyの楽譜が作れるページです">
	<meta property="og:url" content="https://mcbeeringi.github.io/sky/seq.html">
	<meta property="og:image" content="https://mcbeeringi.github.io/sky/img/ico/seq.jpg">
	<!--iOS-->
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="default">
	<meta name="apple-mobile-web-app-title" content="sky instr">
	<link rel="apple-touch-icon" href="img/sky.png">
	<!--sw-->
	<link rel="manifest" href="skymf.json">
	<meta name="theme-color" content="#fea"/>
	<script>
		//if('serviceWorker'in navigator)window.addEventListener('load',()=>{navigator.serviceWorker.register('skysw.js').then((reg)=>{console.log('[ServiceWorker] Registered',reg);});});
	</script>
	<link rel="preload" href="https://tonejs.github.io/build/Tone.js" as="script">
	<link rel="preload" href="seq.js" as="script">
</head>
<body>
	<script src="style.js" async></script>
	<script src="sample.js"></script>
	<script>let ifwebp=new Image();ifwebp.onerror=()=>document.body.classList.add('nowebp');ifwebp.src='img/seq.webp';</script>
	<style>
		:root{user-select:none;-webkit-user-select:none;}/*::-webkit-scrollbar{display:none;}*/
		html,body{height:100%;margin:0;position:relative;}.clear_fix::after{content:"";clear:both;display:block;}

		.dispPanel{position:relative;width:100vw;height:240px;overflow:hidden;border:6px solid #0001;border-left:none;border-right:none;touch-action:manipulation;backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px);
			background:#000a repeating-linear-gradient(#fffc,#fffc 16px,#fff8 16px,#fff8 48px,#fffa 48px,#fffa 64px,#fff8 64px,#fff8 80px,#fffa 80px,#fffa 96px,#fff8 96px,#fff8 112px);}
		.dispPanel>*,#dispScr>*{position:absolute;line-height:16px;font-size:12px;}
		#dispScr{width:100%;height:100%;overflow:scroll;position:relative;}#disp{height:100%;padding:0 64px 0 16px;white-space:nowrap;}
		#dispCur{width:16px;height:100%;background:#bff;left:17px;transition:.1s;border-radius:4px;}
		.nWrapper{display:inline-block;white-space:nowrap;vertical-align:bottom;position:relative;min-width:16px;height:240px;margin-left:1px;border-radius:4px;text-align:center;background-color:#0004;}
		.nWrapper *{color:#fff8;}.nWrapper p{width:14px;height:14px;margin:1px;background:#fea;position:absolute;left:0;border-radius:33%;box-shadow:0 0 4px #888;pointer-events:none;}
		.nWrapper .nWrapper{background:#0002;}.nWrapper .nWrapper:first-child{margin-left:8px;}.nWrapper .nWrapper:last-child{margin-right:8px;}
		#rawtxt{resize:none;width:100%;height:100%;padding:0;border:0;margin:0;position:absolute;top:0;left:0;right:0;bottom:0;background:#0000;display:none;font-family:monospace;font-size:16px;color:#fff;}
		#rawtxt::placeholder,#name_::placeholder{color:#fff4;}

		.uiPanel{float:right;clear:right;}
		.grid{position:relative;display:inline-block;width:48px;height:48px;margin:2px;background:#4448;color:#0000;text-shadow:none;border:none;border-radius:25%;box-shadow:0 0 8px #4448;text-align:center;vertical-align:middle;outline:none;padding:0;backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px);touch-action:manipulation;}
		.bg{background-image:url(img/seq.webp);background-size:800% auto;background-position:var(--bp);}.showtxt{color:#caf0f6;text-shadow:0 0 4px #688;font-size:18px;line-height:1.1em;font-family:"M PLUS Rounded 1c",sans-serif;}
		#name_{font-size:large;background:#4448;width:100%;max-width:200px;height:48px;border-radius:12px;border:none;font-family:"M PLUS Rounded 1c",sans-serif;color:#caf0f6;text-shadow:0 0 4px #688;outline:none;padding:0 2px;margin:2px;backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px);}

		.kbPanel{overflow:hidden;position:relative;width:100%;max-width:360px;float:left;clear:left;background:#0004;border-radius:8px;backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px);touch-action:none;}.kbPanel:before{content:"";display:block;padding-top:60%;}
		#kb{position:absolute;top:0;left:0;right:0;bottom:0;perspective:1000px;overflow:hidden;}#kb input{position:absolute;display:none;}#kb>div{height:33.3%;margin:0;}
		#kb p{display:inline-block;width:20%;height:100%;margin:0;position:relative;}
		#kb p::before,#kb p::after{content:"";display:block;width:84%;height:84%;margin:8%;border-radius:20%;position:absolute;}
		#kb p::before{background:#4448;filter:drop-shadow(0 0 4px #444);transition:.02s;}#kb p:not(.press)::before{transition:.2s;}
		#kb p.press::before{background:#fea8;filter:drop-shadow(0 0 4px #fea);transform:scale(.8);}
		#kb p::after{background:url(img/seq.webp);background-size:800%;transition:.4s;background-position:-100% 0;}#kb p:not(.press)::after{transition:.01s;}
		#kb p:nth-child(2n):not(.c)::after{background-position:-200% 0;}
		#kb p.c::after{background-position:0 0;}
		#kb p.press::after{transform:rotateY(360deg)scale(.8);}

		body>input[type="checkbox"]{display:none;}
		#uiflip:checked~* .uiPanel{float:left;clear:left;}#uiflip:checked~* .kbPanel{float:right;clear:right;}
		label.grid{box-shadow:0 0 0 0 #fea inset;transition:.1s;}
		#kblock:checked~* label[for="kblock"],#kbfixed:checked~* label[for="kbfixed"],#rawedit:checked~* label[for="rawedit"]{box-shadow:0 0 2px 4px #fea inset;}
		#kbfixed:checked~* .kbPanel{position:fixed;top:0;left:0;right:0;margin:0 auto;max-width:420px;}
		#rawedit:checked~* #rawtxt{display:block;}#rawedit:checked~* #kb{display:none;}
		#logcb:not(:checked)~#log{display:none;}

		.fg_{position:fixed;width:100%;height:100%;z-index:10;pointer-events:none;}
		#alcb{display:none;}#alcb+label,#albox{opacity:0;pointer-events:none;transition:.2s;}
		#alcb+label{display:block;width:100%;height:100%;background:#0008;backdrop-filter:blur(2px);-webkit-backdrop-filter:blur(2px);}
		#albox{width:calc(90% - 64px);max-width:256px;min-height:128px;max-height:calc(90% - 40px);border-radius:16px;padding:20px;white-space:pre-wrap;background:#4448;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);overflow-y:scroll;text-align:center;}
		#alcb:checked~*{opacity:1;pointer-events:auto;}
		#albox>div{display:inline-block;background:#8884;margin:4px;width:260px;text-align:left;}#albox>div:first-line{font-size:large;}

		.nowebp .bg,.nowebp #kb p::after{background-image:url(img/seq.png);}
		.shake{animation:.3s shake;filter:saturate(0);}
		@keyframes shake{0%{left:-10px;}20%{left:8px;}40%{left:-6px;}60%{left:4px;}80%{left:-2px;}100%{left:0px;}}
	</style>
	<style id="stybeat"></style><style id="styperf"></style>
	<input type="checkbox" id="kblock">
	<input type="checkbox" id="kbfixed" onchange="kblock.checked=this.checked;">
	<input type="checkbox" id="rawedit">
	<input type="checkbox" id="uiflip">
	<input type="checkbox" id="logcb" checked>
	<div class="fg_">
		<pre id="jswarn" style="margin:24px 40px 0 16px;white-space:pre-wrap;">Please enable JavaScript to use this app.</pre><script>jswarn.style.display='none';</script>
		<input type="checkbox" id="alcb"><label for="alcb"></label><pre id="albox" class="style"></pre>
	</div>


	<div class="dispPanel">
		<div id="dispScr"><div id="dispCur"></div><div id="disp">Please wait…</div></div>
		<div style="opacity:.5;pointer-events:none;width:8px;color:#000;text-shadow:0 0 4px #fff;top:0;word-break:break-all;">CBAGFEDCBAGFEDC</div>
		<button onclick="curct();" class="grid bg" style="--bp:-300% -100%;position:absolute;top:0;right:0;width:32px;height:32px;margin:2px 4px;opacity:.8;">scroll to cursor</button>
	</div>
	<div class="clear_fix">
		<div class="uiPanel" style="max-width:312px;">
			         <button id="undobtn" class="grid bg" style="--bp:-300% -200%;transform:scaleX(-1);">undo
			</button><button id="redobtn" class="grid bg" style="--bp:-300% -200%;">redo
			</button><button onclick="tstep(-1);" class="grid bg" style="--bp:-200% -100%;transform:scaleX(-1);">back
			</button><button onclick="ttoggle();" class="grid bg" style="--bp:0 -100%;">start/pause</button><button onclick="tstop();" class="grid bg" style="--bp:-100% -100%;">stop
			</button><button onclick="tstep(1);" class="grid bg" style="--bp:-200% -100%;">forward
			</button><button id="notecopy" class="grid bg" style="--bp:-200% -300%;">copy
			</button><button id="notepaste" class="grid bg" style="--bp:-300% -300%;">paste
			</button><button id="notedel" class="grid bg" style="--bp:-400% -100%;">del
			</button><button id="noteadd" class="grid bg" style="--bp:-500% -100%;">add
			</button><button id="notein" class="grid bg" style="--bp:-600% -100%;">in
			</button><button id="noteout" class="grid bg" style="--bp:-700% -100%;">out</button><br>
		</div>
		<div class="kbPanel">
			<div id="kb">
				<div><p id="kbb00" class="c"></p><p id="kbb01"></p><p id="kbb02"></p><p id="kbb03"></p><p id="kbb04"></p></div>
				<div><p id="kbb10"></p><p id="kbb11"></p><p id="kbb12" class="c"></p><p id="kbb13"></p><p id="kbb14"></p></div>
				<div><p id="kbb20"></p><p id="kbb21"></p><p id="kbb22"></p><p id="kbb23"></p><p id="kbb24" class="c"></p></div>
			</div>
			<textarea id="rawtxt" placeholder="code goes here…"></textarea>
		</div>
	</div>
	<div class="clear_fix">
		<div class="uiPanel" style="max-width:312px;">
			        <label for="kblock" class="grid bg" style="--bp:-100% -200%;">lock keyboard
			</label><label for="kbfixed" class="grid bg" style="--bp:-200% -200%;">practice
			</label><label for="rawedit" class="grid bg" style="--bp:-400% -200%;">edit raw
			</label><button onclick="alert('セーブ予定地');" class="grid bg" style="--bp:-600% -200%;">save
			</button><button onclick="Tone.Transport.pause();styperf.textContent='';load();" class="grid bg" style="--bp:-500% -200%;">load
			</button><button onclick="alert('エクスポート予定地');" class="grid bg" style="--bp:-00% -00%;">null
			</button><button onclick="main.bpm-=6;Tone.Transport.bpm.value-=6;bpm_.value=main.bpm;" class="grid bg" style="--bp:-500% 0;">slow
			</button><label><input id="bpm_" class="grid bg showtxt" onchange="bpmset();" style="--bp:-700% 0;"></input></label><button onclick="main.bpm+=6;Tone.Transport.bpm.value+=6;bpm_.value=main.bpm;" class="grid bg" style="--bp:-400% 0;">fast
			</button><button onclick="sc_.value=--main.sc;" class="grid bg" style="--bp:-500% 0;">down
			</button><label><input id="sc_" class="grid bg showtxt" onchange="scset();" style="--bp:-600% 0;"></input></label><button onclick="sc_.value=++main.sc;" class="grid bg" style="--bp:-400% 0;">up
			</button><label><input id="name_" onchange="nameset();" placeholder="untitled"></input></label><label><input id="ts_" class="grid bg showtxt" onchange="tsset();" style="--bp:-100% -300%;"></input></label><button id="ibtn" class="grid bg" style="--bp:-300% 0;">info</button>
		</div>
	</div>

	<label>sample: <select id="slc" onchange="main=sample[this.value];init();">
		<option value="0">新宝島</option>
		<option value="1">LINE</option>
		<option value="2">\ｵﾌﾛｶﾞﾜｷﾏｼﾀ/</option>
		<option value="3">前前前世</option>
		<option value="4" selected>nyan-cat</option>
		<option value="5">LOSER</option>
	</select></label>
	<button onclick="caches.keys().then(x=>caches.delete(x[0])).then(x=>alert(x))">cache del</button><br>
	<!--
	caches.keys().then(x=>caches.open(x[0])).then(x=>x.delete('/sky/seq.html')).then(x=>log.textContent+=`\ncache del: ${x}`)
	<a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-text="sky_sequencer" data-size="large" data-url="https://mcbeeringi.github.io/sky/seq.html" data-hashtags="">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
	-->
	<pre id="log"></pre>


	<script src="https://tonejs.github.io/build/Tone.js"></script>
	<script src="https://mcbeeringi.github.io/src/requestIdleCallback.min.js"></script>
	<script src="seq.js"></script>
</body>
</html>
